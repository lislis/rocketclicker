import{o as R,w as f,L as N,A as S}from"./index2.js";import{u as C,s as $,i as j,m as v,r as _,n as W,o as y,c as h,g as e,f as b,F as M,k as D,d as k,b as V,a as E,h as H,q as B,v as G,t as A,l as I,x as T,y as O,j as q}from"./index.js";import{c as X}from"./particle.js";import"./isMobile.js";const L={1:{rocket:{x:0,y:450},moon:{x:180,y:150,scale:.22,texture:"moon"},distance:120,bg:{x:0,y:-20,scale:1,width:2e3,texture:"whitepaper"},blurp:"To the Moon!",skyline:{x:0,y:409,width:3905,scale:.9}},2:{rocket:{x:0,y:450},moon:{x:220,y:180,scale:.51,texture:"moon"},distance:220,bg:{x:0,y:0,scale:1,width:2e3,texture:"currencies"},blurp:"Up and to the right!",skyline:{x:0,y:629,width:1415,scale:.34}},3:{rocket:{x:0,y:450},moon:{x:280,y:250,scale:.7,texture:"moon"},distance:300,bg:{x:0,y:-20,scale:1,width:2e3,texture:"headlines"},blurp:"To, to, to, to the moon!",skyline:{x:0,y:2099,width:815,scale:.2}}},z=["x","y","texture"],J=.4,K=55,Q={__name:"Rocket",props:["x","y"],emits:["jump"],setup(p,{emit:s}){const r=C();$(r);const o=j("socket"),l=p,i=v(l,"x"),n=v(l,"y"),t=_(-6),a=_(1),d=window.innerWidth,w=Math.floor(d/K),x=_(1),m=_(1),c=W(()=>t.value<-2?"rocketFire":"rocketEmpty");R(g=>{n.value+=t.value*g,i.value+=a.value*g,t.value+=J*g,r.updateLatestCandlestick({close:n.value}),x.value=Math.floor(i.value/w)});function u(){t.value=-2,a.value=.65}return o.on("new-click",()=>{u()}),f(()=>m.value<x.value,()=>{m.value=x.value;let g={id:x.value,x:i.value,y:n.value,open:n.value,close:n.value,oWick:Math.floor(Math.random()*50),cWick:Math.floor(Math.random()*50)};r.addCandlestick(g)}),f(()=>n.value>window.innerHeight-40,()=>{n.value=window.innerHeight-40,t.value=0,a.value=0}),f(()=>n.value<10,()=>{n.value=10,t.value=0}),f(()=>i.value>window.innerWidth-30,()=>{i.value=window.innerWidth-30,a.value=0}),(g,le)=>(y(),h("sprite",{x:e(i),y:e(n),texture:c.value,"anchor-x":.5,"anchor-y":.5,scale:"0.5"},null,8,z))}},Y=["texture","x","y","rotation","scale"],Z={__name:"Moon",props:["x","y","scale","rotate","texture"],setup(p){const s=p,r=v(s,"x"),o=v(s,"y"),l=v(s,"scale"),i=v(s,"rotate"),n=v(s,"texture");return(t,a)=>(y(),h("container",null,[b("sprite",{"anchor-x":.5,"anchor-y":.5,texture:e(n),x:e(r),y:e(o),rotation:e(i),scale:e(l),alpha:"0.98"},null,8,Y)]))}},P=["x","y","texture","height"],U={__name:"BG",props:["x","y","scale","texture"],setup(p){const s=p,r=v(s,"x"),o=v(s,"y"),l=v(s,"scale"),i=v(s,"texture"),n=j("hHeight",window.outerHeight);return(t,a)=>(y(),h("sprite",{x:e(r),y:e(o)*e(l),texture:e(i),alpha:"0.56",height:e(n)},null,8,P))}},ee=["x","y"],te=["x","y"],F=15,oe={__name:"Candlestick",props:["index"],setup(p){const s=p,o=C().getCandlestickByIndex(s.index),l=W(()=>o.open>o.close?o.open-o.close:o.close-o.open),i=W(()=>o.open<o.close?16711680:65280);function n(a){a.clear(),a.beginFill(i.value,.5),a.drawRect(0,o.y-o.open,F,l.value),a.endFill()}function t(a){const d=F/2;a.clear(),a.lineStyle(2,i.value,.5),a.moveTo(d,-o.oWick),a.lineTo(d,0),a.moveTo(d,l.value),a.lineTo(d,l.value+o.cWick)}return(a,d)=>(y(),h(M,null,[b("graphics",{x:e(o).x,y:e(o).y,onRender:t},null,40,ee),b("graphics",{onRender:n,x:e(o).x,y:e(o).y},null,40,te)],64))}},ne={__name:"CandlestickList",setup(p){const s=C(),{getCandlesticks:r}=$(s);return(o,l)=>(y(!0),h(M,null,D(e(r),(i,n)=>(y(),h("container",{key:i.id},[k(oe,{index:n},null,8,["index"])]))),128))}},se={__name:"Loop",setup(p){const s=V(),r=E(),o=C();H.add("yay","/sounds/yay.wav");function l(m,c){const u=m.x-c.x,g=m.y-c.y;return Math.hypot(u,g)}function i(){n.value=n.value+1,Object.keys(L).length<n.value?s.push({name:"video"}):(o.resetCandlesticks(),s.push({name:"level",params:{level:n.value}}))}const n=_(parseInt(r.params.level,10));let t=B(L[n.value]);const a=_(0),d=_(0),w=_(t.bg.width),x=B({x:window.innerWidth-t.moon.x,y:t.moon.y,rotate:0});return R(m=>{a.value=l(t.rocket,x),x.rotate+=.003*m;const c=m*.99;d.value-=c,w.value-=c,d.value<=-t.bg.width&&(d.value+=t.bg.width*2),w.value<=-t.bg.width&&(w.value+=t.bg.width*2)}),f(()=>a.value<t.distance,()=>{H.play("yay"),X(1),i()}),(m,c)=>(y(),h("container",null,[k(U,{x:d.value,y:e(t).bg.y,scale:e(t).bg.scale,texture:e(t).bg.texture},null,8,["x","y","scale","texture"]),k(U,{x:w.value,y:e(t).bg.y,scale:e(t).bg.scale,texture:e(t).bg.texture},null,8,["x","y","scale","texture"]),k(ne),k(Z,{x:x.x,"onUpdate:x":c[0]||(c[0]=u=>x.x=u),y:x.y,"onUpdate:y":c[1]||(c[1]=u=>x.y=u),scale:e(t).moon.scale,"onUpdate:scale":c[2]||(c[2]=u=>e(t).moon.scale=u),rotate:x.rotate,"onUpdate:rotate":c[3]||(c[3]=u=>x.rotate=u),texture:e(t).moon.texture,"onUpdate:texture":c[4]||(c[4]=u=>e(t).moon.texture=u)},null,8,["x","y","scale","rotate","texture"]),k(Q,{x:e(t).rocket.x,"onUpdate:x":c[5]||(c[5]=u=>e(t).rocket.x=u),y:e(t).rocket.y,"onUpdate:y":c[6]||(c[6]=u=>e(t).rocket.y=u)},null,8,["x","y"])]))}},ae={class:"anim-intro"},ce={__name:"ClickHistory",props:["clicks"],setup(p){const s=_(null);return G(()=>{let r=new MutationObserver(l);const o={childList:!0};r.observe(s.value,o);function l(){s.value.scrollTop=s.value.scrollHeight}}),(r,o)=>(y(),h("ul",{class:"clickhistory",ref_key:"clickcontainer",ref:s},[(y(!0),h(M,null,D(p.clicks,l=>(y(),h("li",ae,[b("strong",null,A(l.username),1),I(" clicked!")]))),256))],512))}},re=b("text",{anchor:.5,x:120,y:120,style:{fill:"white"}}," Laden... ",-1),pe={__name:"GameView",setup(p){const s=C(),{getGame:r,getClicks:o}=$(s),l=V(),i=window.innerWidth,n=window.outerHeight,t=window.devicePixelRatio,a={moon:"/textures/moon3.png",bg1:"/textures/background-stars2.png",whitepaper:"/textures/whitepaper2.png",currencies:"/textures/currencies2.png",headlines:"/textures/headlines.png",rocketFire:"/textures/rocket2-fire.png",rocketEmpty:"/textures/rocket2.png",bitcoin:"/textures/bitcoin.png"};return(r.value===void 0||r.value===null)&&l.push({name:"waiting"}),f(()=>r.value===void 0||r.value===null,()=>l.push({name:"waiting"})),(d,w)=>(y(),h(M,null,[k(ce,{clicks:e(o)},null,8,["clicks"]),k(e(S),{width:e(i),height:e(n),resolution:e(t),backgroundColor:"#3c2f6b"},{default:T(()=>[k(e(N),{resources:a},{fallback:T(()=>[re]),default:T(({textures:x})=>[e(r)?(y(),O(se,{key:0})):q("",!0)]),_:1})]),_:1},8,["width","height","resolution"])],64))}};export{pe as default};
