import{o as j,w as b,L as A,A as I}from"./index2.js";import{u as M,s as H,i as D,n as h,r as g,q as $,o as y,c as m,g as e,f as C,F as T,l as N,d as k,b as S,a as O,h as B,v as L,x as q,t as z,m as J,y as W,z as X,k as K}from"./index.js";import"./isMobile.js";const V={1:{rocket:{x:0,y:650},moon:{x:170,y:170,scale:.31,texture:"moon"},distance:160,bg:{x:0,y:0,scale:1,width:2e3,texture:"whitepaper"},blurp:"To the Moon!",skyline:{x:0,y:409,width:3905,scale:.9}},2:{rocket:{x:0,y:550},moon:{x:220,y:200,scale:.51,texture:"moon"},distance:250,bg:{x:0,y:0,scale:1,width:2e3,texture:"currencies"},blurp:"Up and to the right!",skyline:{x:0,y:629,width:1415,scale:.34}},3:{rocket:{x:0,y:550},moon:{x:280,y:280,scale:.7,texture:"moon"},distance:340,bg:{x:0,y:0,scale:1,width:2e3,texture:"headlines"},blurp:"To, to, to, to the moon!",skyline:{x:0,y:2099,width:815,scale:.2}}},Q=["x","y","texture"],Y=.3,Z=55,P={__name:"Rocket",props:["x","y"],emits:["jump"],setup(p,{emit:s}){const l=M(),{getCandlesticks:o,getUsers:r,getJumpVal:d}=H(l),i=D("socket"),t=p,n=h(t,"x"),a=h(t,"y"),w=d,x=g(-6),v=g(1),c=window.innerWidth,u=Math.floor(c/Z),f=g(1),U=g(1),E=$(()=>x.value<-.6?"rocketFire":"rocketEmpty");j(_=>{a.value+=x.value*_,n.value+=v.value*_,x.value+=Y*_,l.updateLatestCandlestick({close:a.value}),f.value=Math.floor(n.value/u)});function G(){let _=w.value*-1;x.value=_,v.value=.65}return i.on("new-click",()=>{G()}),b(()=>U.value<f.value,()=>{U.value=f.value;let _={id:f.value,x:n.value,y:a.value,open:a.value,close:a.value,oWick:Math.floor(Math.random()*50),cWick:Math.floor(Math.random()*50)};l.addCandlestick(_)}),b(()=>a.value>window.innerHeight-40,()=>{a.value=window.innerHeight-40,x.value=0,v.value=0}),b(()=>a.value<10,()=>{a.value=10,x.value=0}),b(()=>n.value>window.innerWidth-30,()=>{n.value=window.innerWidth-30,v.value=0}),(_,xe)=>(y(),m("sprite",{x:e(n),y:e(a),texture:E.value,"anchor-x":.5,"anchor-y":.5,scale:"0.5"},null,8,Q))}},ee=["texture","x","y","rotation","scale"],te={__name:"Moon",props:["x","y","scale","rotate","texture"],setup(p){const s=p,l=h(s,"x"),o=h(s,"y"),r=h(s,"scale"),d=h(s,"rotate"),i=h(s,"texture");return(t,n)=>(y(),m("container",null,[C("sprite",{"anchor-x":.5,"anchor-y":.5,texture:e(i),x:e(l),y:e(o),rotation:e(d),scale:e(r),alpha:"0.98"},null,8,ee)]))}},oe=["x","y","texture","height"],F={__name:"BG",props:["x","y","scale","texture"],setup(p){const s=p,l=h(s,"x"),o=h(s,"y"),r=h(s,"scale"),d=h(s,"texture"),i=D("hHeight",window.outerHeight);return(t,n)=>(y(),m("sprite",{x:e(l),y:e(o)*e(r),texture:e(d),alpha:"0.56",height:e(i)},null,8,oe))}},ne=["x","y"],se=["x","y"],R=15,ae={__name:"Candlestick",props:["index"],setup(p){const s=p,o=M().getCandlestickByIndex(s.index),r=$(()=>o.open>o.close?o.open-o.close:o.close-o.open),d=$(()=>o.open<o.close?16711680:65280);function i(n){n.clear(),n.beginFill(d.value,.5),n.drawRect(0,o.y-o.open,R,r.value),n.endFill()}function t(n){const a=R/2;n.clear(),n.lineStyle(2,d.value,.5),n.moveTo(a,-o.oWick),n.lineTo(a,0),n.moveTo(a,r.value),n.lineTo(a,r.value+o.cWick)}return(n,a)=>(y(),m(T,null,[C("graphics",{x:e(o).x,y:e(o).y,onRender:t},null,40,ne),C("graphics",{onRender:i,x:e(o).x,y:e(o).y},null,40,se)],64))}},ce={__name:"CandlestickList",setup(p){const s=M(),{getCandlesticks:l}=H(s);return(o,r)=>(y(!0),m(T,null,N(e(l),(d,i)=>(y(),m("container",{key:d.id},[k(ae,{index:i},null,8,["index"])]))),128))}},le={__name:"Loop",setup(p){const s=S(),l=O(),o=M();B.add("yay","/sounds/yay.wav");function r(v,c){const u=v.x-c.x,f=v.y-c.y;return Math.hypot(u,f)}function d(){i.value=i.value+1,Object.keys(V).length<i.value?s.push({name:"video"}):(o.resetCandlesticks(),s.push({name:"level",params:{level:i.value}}))}const i=g(parseInt(l.params.level,10));let t=L(V[i.value]);const n=g(0),a=g(0),w=g(t.bg.width),x=L({x:window.innerWidth-t.moon.x,y:t.moon.y,rotate:0});return j(v=>{n.value=r(t.rocket,x),x.rotate+=.003*v;const c=v*.99;a.value-=c,w.value-=c,a.value<=-t.bg.width&&(a.value+=t.bg.width*2),w.value<=-t.bg.width&&(w.value+=t.bg.width*2)}),b(()=>n.value<t.distance,()=>{B.play("yay"),d()}),(v,c)=>(y(),m("container",null,[k(F,{x:a.value,y:e(t).bg.y,scale:e(t).bg.scale,texture:e(t).bg.texture},null,8,["x","y","scale","texture"]),k(F,{x:w.value,y:e(t).bg.y,scale:e(t).bg.scale,texture:e(t).bg.texture},null,8,["x","y","scale","texture"]),k(ce),k(te,{x:x.x,"onUpdate:x":c[0]||(c[0]=u=>x.x=u),y:x.y,"onUpdate:y":c[1]||(c[1]=u=>x.y=u),scale:e(t).moon.scale,"onUpdate:scale":c[2]||(c[2]=u=>e(t).moon.scale=u),rotate:x.rotate,"onUpdate:rotate":c[3]||(c[3]=u=>x.rotate=u),texture:e(t).moon.texture,"onUpdate:texture":c[4]||(c[4]=u=>e(t).moon.texture=u)},null,8,["x","y","scale","rotate","texture"]),k(P,{x:e(t).rocket.x,"onUpdate:x":c[5]||(c[5]=u=>e(t).rocket.x=u),y:e(t).rocket.y,"onUpdate:y":c[6]||(c[6]=u=>e(t).rocket.y=u)},null,8,["x","y"])]))}},re={class:"anim-intro"},ie={__name:"ClickHistory",props:["clicks"],setup(p){const s=g(null);return q(()=>{let l=new MutationObserver(r);const o={childList:!0};l.observe(s.value,o);function r(){s.value.scrollTop=s.value.scrollHeight}}),(l,o)=>(y(),m("ul",{class:"clickhistory",ref_key:"clickcontainer",ref:s},[(y(!0),m(T,null,N(p.clicks,r=>(y(),m("li",re,[C("strong",null,z(r.username),1),J(" clicked!")]))),256))],512))}},ue=C("text",{anchor:.5,x:120,y:120,style:{fill:"white"}}," Laden... ",-1),ve={__name:"GameView",setup(p){const s=M(),{getGame:l,getClicks:o}=H(s),r=S(),d=window.innerWidth,i=window.outerHeight,t=window.devicePixelRatio,n={moon:"/textures/moon3.png",bg1:"/textures/background-stars2.png",whitepaper:"/textures/whitepaper2.png",currencies:"/textures/currencies2.png",headlines:"/textures/headlines.png",rocketFire:"/textures/rocket2-fire.png",rocketEmpty:"/textures/rocket2.png",bitcoin:"/textures/bitcoin.png"};return(l.value===void 0||l.value===null)&&r.push({name:"waiting"}),b(()=>l.value===void 0||l.value===null,()=>r.push({name:"waiting"})),(a,w)=>(y(),m(T,null,[k(ie,{clicks:e(o)},null,8,["clicks"]),k(e(I),{width:e(d),height:e(i),resolution:e(t),backgroundColor:"#3c2f6b"},{default:W(()=>[k(e(A),{resources:n},{fallback:W(()=>[ue]),default:W(({textures:x})=>[e(l)?(y(),X(le,{key:0})):K("",!0)]),_:1})]),_:1},8,["width","height","resolution"])],64))}};export{ve as default};
